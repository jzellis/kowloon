'use strict';

var fs = require('fs');
var pify = require('pify');
var isExe = function isExe(mode, gid, uid) {
  if (process.platform === 'win32') {
    return true;
  }
  var isGroup = gid ? process.getgid && gid === process.getgid() : true;
  var isUser = uid ? process.getuid && uid === process.getuid() : true;
  return Boolean(mode & 1 || mode & 8 && isGroup || mode & 64 && isUser);
};
module.exports = function (name) {
  if (typeof name !== 'string') {
    return Promise.reject(new TypeError('Expected a string'));
  }
  return pify(fs.stat)(name).then(function (stats) {
    return stats && stats.isFile() && isExe(stats.mode, stats.gid, stats.uid);
  });
};
module.exports.sync = function (name) {
  if (typeof name !== 'string') {
    throw new TypeError('Expected a string');
  }
  var stats = fs.statSync(name);
  return stats && stats.isFile() && isExe(stats.mode, stats.gid, stats.uid);
};
module.exports.checkMode = isExe;